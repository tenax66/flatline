#!/usr/bin/env python3

import sys

def main():
    # å¼•æ•°ã®ãƒã‚§ãƒƒã‚¯
    if len(sys.argv) < 4:
        print("ä½¿ç”¨æ–¹æ³•: {} <ã‚¿ã‚¤ãƒˆãƒ«> <ä½œè€…> <çŸ­æ­Œ>".format(sys.argv[0]))
        sys.exit(1)

    title = sys.argv[1]
    author = sys.argv[2]
    tanka = sys.argv[3]

    # ä½œè€…åã¨çµµæ–‡å­—ã®å¯¾å¿œãƒªã‚¹ãƒˆã‚’å®šç¾©
    emoji_map = {
        "é’é‡ã‚†ã‚‰ã": "ğŸ•", "çŠ¬ã®æ³¨å°„": "ğŸ’‰", "domeki": "ğŸï¸",
        "ã‚µãƒ©ãƒªãƒ¼ãƒãƒ³äºˆæƒ³": "ğŸ˜ï¸", "ã‚ªãƒ«ã‚¿ãƒ¼å ‚": "ğŸ¸", "ç¦ä½é›»": "ğŸ’¡",
        "æ±å·å¤¢ç‰©èª": "ğŸ¦·", "ãŠã–ã‚": "ğŸ§¢", "æ±Ÿé–“ã‚ã‚„ã›": "ğŸ³",
        "éé‹­ç†å": "ğŸ•¯ï¸", "å½¦å‡ª è‡³": "ğŸ§­", "ç‰¹ä¸Šã‚ã„ã†": "ğŸ ",
        "ç‚¹ç·šç”»é‹²": "ğŸ“Œ", "å¥¥åœ’": "ğŸª´", "ãƒ’ãƒŸãƒ„ãƒ¼": "ğŸ¤«",
        "å†¨å²¡æ­£å¤ªéƒ": "ğŸº", "å¤•å‡ªã‚‰ã“": "ğŸ§Š", "ã‚å­": "ğŸ‘",
        "å®‡ä½ç”°ç°åŠ ": "ğŸ°", "å…«è°·ã®ã‚Š": "ğŸ", "äº¬é‡æ­£åˆ": "ğŸ•›",
        "ä¸‰å¥½ã—ã»": "ğŸ«–", "ç¦ç”°å…­å€‹": "ğŸ¦Ÿ", "å¤ªæœ—åƒå°‹": "ğŸ’»",
        "å°¾å†…ç”²å¤ªéƒ": "ğŸª²", "ç¥ä¹ƒ": "ğŸ¦€", "é«˜æ©‹å¯§": "ğŸª",
        "ç¹”åŸç¦¾": "â›ªï¸", "éµºæ²¼ã“ã‚‚ã‚Š": "ğŸ©", "å°è¥¿å–„ä»": "ğŸŠ",
        "ã‚†ã‚‹ã‚‚ã¡ã‚†": "ğŸ¡", "å”¯ç¹”æ˜": "ğŸ–±ï¸", "è›¸": "ğŸ§â€â™‚ï¸"
    }

    # çµµæ–‡å­—ã®å–å¾— (è©²å½“ãŒãªã‘ã‚Œã°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
    emoji = emoji_map.get(author, "â“")

    # çŸ­æ­Œã®æ•´å½¢ (æ”¹è¡Œã‚’ <p> ã‚¿ã‚°ã«å¤‰æ›)
    tanka_lines = tanka.split("\\n")
    tanka_main = "\n".join(f"<p>{line}</p>" for line in tanka_lines)
    tanka_summary = "<br/>".join(tanka_lines)

    # Jekyllç”¨ã®æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ç”Ÿæˆ
    output_html = f"""---
layout: post
title: {title}
image: /assets/images/ogp_default.png
author: {author}
category: {author}
emoji: {emoji}
---

<div class=\"tanka-area\"><div class=\"tanka\">
{tanka_main}</div></div>

---

<details><summary>{title}</summary>
{tanka_summary}<br/>
<br/>
</details>

{author}"""

    # çµæœã‚’è¡¨ç¤º
    print(output_html)

if __name__ == "__main__":
    main()
